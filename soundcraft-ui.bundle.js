var It=function(r,e){return It=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])},It(r,e)};function I(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");It(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Le=function(){return Le=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},Le.apply(this,arguments)};function nr(r,e,t,n){function o(i){return i instanceof t?i:new t(function(s){s(i)})}return new(t||(t=Promise))(function(i,s){function a(p){try{c(n.next(p))}catch(f){s(f)}}function u(p){try{c(n.throw(p))}catch(f){s(f)}}function c(p){p.done?i(p.value):o(p.value).then(a,u)}c((n=n.apply(r,e||[])).next())})}function Fe(r,e){var t={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,s=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return s.next=a(0),s.throw=a(1),s.return=a(2),typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(c){return function(p){return u([c,p])}}function u(c){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,c[0]&&(t=0)),t;)try{if(n=1,o&&(i=c[0]&2?o.return:c[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,c[1])).done)return i;switch(o=0,i&&(c=[c[0]&2,i.value]),c[0]){case 0:case 1:i=c;break;case 4:return t.label++,{value:c[1],done:!1};case 5:t.label++,o=c[1],c=[0];continue;case 7:c=t.ops.pop(),t.trys.pop();continue;default:if(i=t.trys,!(i=i.length>0&&i[i.length-1])&&(c[0]===6||c[0]===2)){t=0;continue}if(c[0]===3&&(!i||c[1]>i[0]&&c[1]<i[3])){t.label=c[1];break}if(c[0]===6&&t.label<i[1]){t.label=i[1],i=c;break}if(i&&t.label<i[2]){t.label=i[2],t.ops.push(c);break}i[2]&&t.ops.pop(),t.trys.pop();continue}c=e.call(r,t)}catch(p){c=[6,p],o=0}finally{n=i=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}function W(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function P(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var n=t.call(r),o,i=[],s;try{for(;(e===void 0||e-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(a){s={error:a}}finally{try{o&&!o.done&&(t=n.return)&&t.call(n)}finally{if(s)throw s.error}}return i}function D(r,e,t){if(t||arguments.length===2)for(var n=0,o=e.length,i;n<o;n++)(i||!(n in e))&&(i||(i=Array.prototype.slice.call(e,0,n)),i[n]=e[n]);return r.concat(i||Array.prototype.slice.call(e))}function Z(r){return this instanceof Z?(this.v=r,this):new Z(r)}function or(r,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(r,e||[]),o,i=[];return o=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",s),o[Symbol.asyncIterator]=function(){return this},o;function s(h){return function($){return Promise.resolve($).then(h,f)}}function a(h,$){n[h]&&(o[h]=function(d){return new Promise(function(k,F){i.push([h,d,k,F])>1||u(h,d)})},$&&(o[h]=$(o[h])))}function u(h,$){try{c(n[h]($))}catch(d){v(i[0][3],d)}}function c(h){h.value instanceof Z?Promise.resolve(h.value.v).then(p,f):v(i[0][2],h)}function p(h){u("next",h)}function f(h){u("throw",h)}function v(h,$){h($),i.shift(),i.length&&u(i[0][0],i[0][1])}}function ir(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=r[Symbol.asyncIterator],t;return e?e.call(r):(r=typeof W=="function"?W(r):r[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(i){t[i]=r[i]&&function(s){return new Promise(function(a,u){s=r[i](s),o(a,u,s.done,s.value)})}}function o(i,s,a,u){Promise.resolve(u).then(function(c){i({value:c,done:a})},s)}}function x(r){return typeof r=="function"}function me(r){var e=function(n){Error.call(n),n.stack=new Error().stack},t=r(e);return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var je=me(function(r){return function(t){r(this),this.message=t?t.length+` errors occurred during unsubscription:
`+t.map(function(n,o){return o+1+") "+n.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=t}});function Q(r,e){if(r){var t=r.indexOf(e);0<=t&&r.splice(t,1)}}var V=(function(){function r(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return r.prototype.unsubscribe=function(){var e,t,n,o,i;if(!this.closed){this.closed=!0;var s=this._parentage;if(s)if(this._parentage=null,Array.isArray(s))try{for(var a=W(s),u=a.next();!u.done;u=a.next()){var c=u.value;c.remove(this)}}catch(d){e={error:d}}finally{try{u&&!u.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}else s.remove(this);var p=this.initialTeardown;if(x(p))try{p()}catch(d){i=d instanceof je?d.errors:[d]}var f=this._finalizers;if(f){this._finalizers=null;try{for(var v=W(f),h=v.next();!h.done;h=v.next()){var $=h.value;try{sr($)}catch(d){i=i??[],d instanceof je?i=D(D([],P(i)),P(d.errors)):i.push(d)}}}catch(d){n={error:d}}finally{try{h&&!h.done&&(o=v.return)&&o.call(v)}finally{if(n)throw n.error}}}if(i)throw new je(i)}},r.prototype.add=function(e){var t;if(e&&e!==this)if(this.closed)sr(e);else{if(e instanceof r){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}},r.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},r.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},r.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&Q(t,e)},r.prototype.remove=function(e){var t=this._finalizers;t&&Q(t,e),e instanceof r&&e._removeParent(this)},r.EMPTY=(function(){var e=new r;return e.closed=!0,e})(),r})();var kt=V.EMPTY;function Re(r){return r instanceof V||r&&"closed"in r&&x(r.remove)&&x(r.add)&&x(r.unsubscribe)}function sr(r){x(r)?r():r.unsubscribe()}var j={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var fe={setTimeout:function(r,e){for(var t=[],n=2;n<arguments.length;n++)t[n-2]=arguments[n];var o=fe.delegate;return o?.setTimeout?o.setTimeout.apply(o,D([r,e],P(t))):setTimeout.apply(void 0,D([r,e],P(t)))},clearTimeout:function(r){var e=fe.delegate;return(e?.clearTimeout||clearTimeout)(r)},delegate:void 0};function Be(r){fe.setTimeout(function(){var e=j.onUnhandledError;if(e)e(r);else throw r})}function N(){}var ar=(function(){return Ot("C",void 0,void 0)})();function ur(r){return Ot("E",void 0,r)}function cr(r){return Ot("N",r,void 0)}function Ot(r,e,t){return{kind:r,value:e,error:t}}var ee=null;function le(r){if(j.useDeprecatedSynchronousErrorHandling){var e=!ee;if(e&&(ee={errorThrown:!1,error:null}),r(),e){var t=ee,n=t.errorThrown,o=t.error;if(ee=null,n)throw o}}else r()}function pr(r){j.useDeprecatedSynchronousErrorHandling&&ee&&(ee.errorThrown=!0,ee.error=r)}var te=(function(r){I(e,r);function e(t){var n=r.call(this)||this;return n.isStopped=!1,t?(n.destination=t,Re(t)&&t.add(n)):n.destination=_n,n}return e.create=function(t,n,o){return new G(t,n,o)},e.prototype.next=function(t){this.isStopped?Dt(cr(t),this):this._next(t)},e.prototype.error=function(t){this.isStopped?Dt(ur(t),this):(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped?Dt(ar,this):(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,r.prototype.unsubscribe.call(this),this.destination=null)},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){try{this.destination.error(t)}finally{this.unsubscribe()}},e.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},e})(V);var $n=Function.prototype.bind;function Pt(r,e){return $n.call(r,e)}var Mn=(function(){function r(e){this.partialObserver=e}return r.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(n){Ve(n)}},r.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(n){Ve(n)}else Ve(e)},r.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(t){Ve(t)}},r})(),G=(function(r){I(e,r);function e(t,n,o){var i=r.call(this)||this,s;if(x(t)||!t)s={next:t??void 0,error:n??void 0,complete:o??void 0};else{var a;i&&j.useDeprecatedNextContext?(a=Object.create(t),a.unsubscribe=function(){return i.unsubscribe()},s={next:t.next&&Pt(t.next,a),error:t.error&&Pt(t.error,a),complete:t.complete&&Pt(t.complete,a)}):s=t}return i.destination=new Mn(s),i}return e})(te);function Ve(r){j.useDeprecatedSynchronousErrorHandling?pr(r):Be(r)}function Cn(r){throw r}function Dt(r,e){var t=j.onStoppedNotification;t&&fe.setTimeout(function(){return t(r,e)})}var _n={closed:!0,next:N,error:Cn,complete:N};var he=(function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"})();function A(r){return r}function At(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];return Lt(r)}function Lt(r){return r.length===0?A:r.length===1?r[0]:function(t){return r.reduce(function(n,o){return o(n)},t)}}var w=(function(){function r(e){e&&(this._subscribe=e)}return r.prototype.lift=function(e){var t=new r;return t.source=this,t.operator=e,t},r.prototype.subscribe=function(e,t,n){var o=this,i=In(e)?e:new G(e,t,n);return le(function(){var s=o,a=s.operator,u=s.source;i.add(a?a.call(i,u):u?o._subscribe(i):o._trySubscribe(i))}),i},r.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},r.prototype.forEach=function(e,t){var n=this;return t=mr(t),new t(function(o,i){var s=new G({next:function(a){try{e(a)}catch(u){i(u),s.unsubscribe()}},error:i,complete:o});n.subscribe(s)})},r.prototype._subscribe=function(e){var t;return(t=this.source)===null||t===void 0?void 0:t.subscribe(e)},r.prototype[he]=function(){return this},r.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Lt(e)(this)},r.prototype.toPromise=function(e){var t=this;return e=mr(e),new e(function(n,o){var i;t.subscribe(function(s){return i=s},function(s){return o(s)},function(){return n(i)})})},r.create=function(e){return new r(e)},r})();function mr(r){var e;return(e=r??j.Promise)!==null&&e!==void 0?e:Promise}function En(r){return r&&x(r.next)&&x(r.error)&&x(r.complete)}function In(r){return r&&r instanceof te||En(r)&&Re(r)}function kn(r){return x(r?.lift)}function S(r){return function(e){if(kn(e))return e.lift(function(t){try{return r(t,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}function y(r,e,t,n,o){return new On(r,e,t,n,o)}var On=(function(r){I(e,r);function e(t,n,o,i,s,a){var u=r.call(this,t)||this;return u.onFinalize=s,u.shouldUnsubscribe=a,u._next=n?function(c){try{n(c)}catch(p){t.error(p)}}:r.prototype._next,u._error=i?function(c){try{i(c)}catch(p){t.error(p)}finally{this.unsubscribe()}}:r.prototype._error,u._complete=o?function(){try{o()}catch(c){t.error(c)}finally{this.unsubscribe()}}:r.prototype._complete,u}return e.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;r.prototype.unsubscribe.call(this),!n&&((t=this.onFinalize)===null||t===void 0||t.call(this))}},e})(te);var fr=me(function(r){return function(){r(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}});var E=(function(r){I(e,r);function e(){var t=r.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return e.prototype.lift=function(t){var n=new Ue(this,this);return n.operator=t,n},e.prototype._throwIfClosed=function(){if(this.closed)throw new fr},e.prototype.next=function(t){var n=this;le(function(){var o,i;if(n._throwIfClosed(),!n.isStopped){n.currentObservers||(n.currentObservers=Array.from(n.observers));try{for(var s=W(n.currentObservers),a=s.next();!a.done;a=s.next()){var u=a.value;u.next(t)}}catch(c){o={error:c}}finally{try{a&&!a.done&&(i=s.return)&&i.call(s)}finally{if(o)throw o.error}}}})},e.prototype.error=function(t){var n=this;le(function(){if(n._throwIfClosed(),!n.isStopped){n.hasError=n.isStopped=!0,n.thrownError=t;for(var o=n.observers;o.length;)o.shift().error(t)}})},e.prototype.complete=function(){var t=this;le(function(){if(t._throwIfClosed(),!t.isStopped){t.isStopped=!0;for(var n=t.observers;n.length;)n.shift().complete()}})},e.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(e.prototype,"observed",{get:function(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0},enumerable:!1,configurable:!0}),e.prototype._trySubscribe=function(t){return this._throwIfClosed(),r.prototype._trySubscribe.call(this,t)},e.prototype._subscribe=function(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)},e.prototype._innerSubscribe=function(t){var n=this,o=this,i=o.hasError,s=o.isStopped,a=o.observers;return i||s?kt:(this.currentObservers=null,a.push(t),new V(function(){n.currentObservers=null,Q(a,t)}))},e.prototype._checkFinalizedStatuses=function(t){var n=this,o=n.hasError,i=n.thrownError,s=n.isStopped;o?t.error(i):s&&t.complete()},e.prototype.asObservable=function(){var t=new w;return t.source=this,t},e.create=function(t,n){return new Ue(t,n)},e})(w);var Ue=(function(r){I(e,r);function e(t,n){var o=r.call(this)||this;return o.destination=t,o.source=n,o}return e.prototype.next=function(t){var n,o;(o=(n=this.destination)===null||n===void 0?void 0:n.next)===null||o===void 0||o.call(n,t)},e.prototype.error=function(t){var n,o;(o=(n=this.destination)===null||n===void 0?void 0:n.error)===null||o===void 0||o.call(n,t)},e.prototype.complete=function(){var t,n;(n=(t=this.destination)===null||t===void 0?void 0:t.complete)===null||n===void 0||n.call(t)},e.prototype._subscribe=function(t){var n,o;return(o=(n=this.source)===null||n===void 0?void 0:n.subscribe(t))!==null&&o!==void 0?o:kt},e})(E);var $e={now:function(){return($e.delegate||Date).now()},delegate:void 0};var H=(function(r){I(e,r);function e(t,n,o){t===void 0&&(t=1/0),n===void 0&&(n=1/0),o===void 0&&(o=$e);var i=r.call(this)||this;return i._bufferSize=t,i._windowTime=n,i._timestampProvider=o,i._buffer=[],i._infiniteTimeWindow=!0,i._infiniteTimeWindow=n===1/0,i._bufferSize=Math.max(1,t),i._windowTime=Math.max(1,n),i}return e.prototype.next=function(t){var n=this,o=n.isStopped,i=n._buffer,s=n._infiniteTimeWindow,a=n._timestampProvider,u=n._windowTime;o||(i.push(t),!s&&i.push(a.now()+u)),this._trimBuffer(),r.prototype.next.call(this,t)},e.prototype._subscribe=function(t){this._throwIfClosed(),this._trimBuffer();for(var n=this._innerSubscribe(t),o=this,i=o._infiniteTimeWindow,s=o._buffer,a=s.slice(),u=0;u<a.length&&!t.closed;u+=i?1:2)t.next(a[u]);return this._checkFinalizedStatuses(t),n},e.prototype._trimBuffer=function(){var t=this,n=t._bufferSize,o=t._timestampProvider,i=t._buffer,s=t._infiniteTimeWindow,a=(s?1:2)*n;if(n<1/0&&a<i.length&&i.splice(0,i.length-a),!s){for(var u=o.now(),c=0,p=1;p<i.length&&i[p]<=u;p+=2)c=p;c&&i.splice(0,c+1)}},e})(E);var lr=(function(r){I(e,r);function e(t,n){return r.call(this)||this}return e.prototype.schedule=function(t,n){return n===void 0&&(n=0),this},e})(V);var Me={setInterval:function(r,e){for(var t=[],n=2;n<arguments.length;n++)t[n-2]=arguments[n];var o=Me.delegate;return o?.setInterval?o.setInterval.apply(o,D([r,e],P(t))):setInterval.apply(void 0,D([r,e],P(t)))},clearInterval:function(r){var e=Me.delegate;return(e?.clearInterval||clearInterval)(r)},delegate:void 0};var hr=(function(r){I(e,r);function e(t,n){var o=r.call(this,t,n)||this;return o.scheduler=t,o.work=n,o.pending=!1,o}return e.prototype.schedule=function(t,n){var o;if(n===void 0&&(n=0),this.closed)return this;this.state=t;var i=this.id,s=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(s,i,n)),this.pending=!0,this.delay=n,this.id=(o=this.id)!==null&&o!==void 0?o:this.requestAsyncId(s,this.id,n),this},e.prototype.requestAsyncId=function(t,n,o){return o===void 0&&(o=0),Me.setInterval(t.flush.bind(t,this),o)},e.prototype.recycleAsyncId=function(t,n,o){if(o===void 0&&(o=0),o!=null&&this.delay===o&&this.pending===!1)return n;n!=null&&Me.clearInterval(n)},e.prototype.execute=function(t,n){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var o=this._execute(t,n);if(o)return o;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},e.prototype._execute=function(t,n){var o=!1,i;try{this.work(t)}catch(s){o=!0,i=s||new Error("Scheduled action threw falsy error")}if(o)return this.unsubscribe(),i},e.prototype.unsubscribe=function(){if(!this.closed){var t=this,n=t.id,o=t.scheduler,i=o.actions;this.work=this.state=this.scheduler=null,this.pending=!1,Q(i,this),n!=null&&(this.id=this.recycleAsyncId(o,n,null)),this.delay=null,r.prototype.unsubscribe.call(this)}},e})(lr);var Ft=(function(){function r(e,t){t===void 0&&(t=r.now),this.schedulerActionCtor=e,this.now=t}return r.prototype.schedule=function(e,t,n){return t===void 0&&(t=0),new this.schedulerActionCtor(this,e).schedule(n,t)},r.now=$e.now,r})();var dr=(function(r){I(e,r);function e(t,n){n===void 0&&(n=Ft.now);var o=r.call(this,t,n)||this;return o.actions=[],o._active=!1,o}return e.prototype.flush=function(t){var n=this.actions;if(this._active){n.push(t);return}var o;this._active=!0;do if(o=t.execute(t.state,t.delay))break;while(t=n.shift());if(this._active=!1,o){for(;t=n.shift();)t.unsubscribe();throw o}},e})(Ft);var re=new dr(hr),br=re;var We=new w(function(r){return r.complete()});function Ne(r){return r&&x(r.schedule)}function jt(r){return r[r.length-1]}function Ge(r){return x(jt(r))?r.pop():void 0}function K(r){return Ne(jt(r))?r.pop():void 0}function vr(r,e){return typeof jt(r)=="number"?r.pop():e}var ze=(function(r){return r&&typeof r.length=="number"&&typeof r!="function"});function Ye(r){return x(r?.then)}function He(r){return x(r[he])}function Ke(r){return Symbol.asyncIterator&&x(r?.[Symbol.asyncIterator])}function qe(r){return new TypeError("You provided "+(r!==null&&typeof r=="object"?"an invalid object":"'"+r+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function Pn(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Je=Pn();function Xe(r){return x(r?.[Je])}function Ze(r){return or(this,arguments,function(){var t,n,o,i;return Fe(this,function(s){switch(s.label){case 0:t=r.getReader(),s.label=1;case 1:s.trys.push([1,,9,10]),s.label=2;case 2:return[4,Z(t.read())];case 3:return n=s.sent(),o=n.value,i=n.done,i?[4,Z(void 0)]:[3,5];case 4:return[2,s.sent()];case 5:return[4,Z(o)];case 6:return[4,s.sent()];case 7:return s.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}})})}function Qe(r){return x(r?.getReader)}function T(r){if(r instanceof w)return r;if(r!=null){if(He(r))return Dn(r);if(ze(r))return An(r);if(Ye(r))return Ln(r);if(Ke(r))return xr(r);if(Xe(r))return Fn(r);if(Qe(r))return jn(r)}throw qe(r)}function Dn(r){return new w(function(e){var t=r[he]();if(x(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function An(r){return new w(function(e){for(var t=0;t<r.length&&!e.closed;t++)e.next(r[t]);e.complete()})}function Ln(r){return new w(function(e){r.then(function(t){e.closed||(e.next(t),e.complete())},function(t){return e.error(t)}).then(null,Be)})}function Fn(r){return new w(function(e){var t,n;try{for(var o=W(r),i=o.next();!i.done;i=o.next()){var s=i.value;if(e.next(s),e.closed)return}}catch(a){t={error:a}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}e.complete()})}function xr(r){return new w(function(e){Rn(r,e).catch(function(t){return e.error(t)})})}function jn(r){return xr(Ze(r))}function Rn(r,e){var t,n,o,i;return nr(this,void 0,void 0,function(){var s,a;return Fe(this,function(u){switch(u.label){case 0:u.trys.push([0,5,6,11]),t=ir(r),u.label=1;case 1:return[4,t.next()];case 2:if(n=u.sent(),!!n.done)return[3,4];if(s=n.value,e.next(s),e.closed)return[2];u.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return a=u.sent(),o={error:a},[3,11];case 6:return u.trys.push([6,,9,10]),n&&!n.done&&(i=t.return)?[4,i.call(t)]:[3,8];case 7:u.sent(),u.label=8;case 8:return[3,10];case 9:if(o)throw o.error;return[7];case 10:return[7];case 11:return e.complete(),[2]}})})}function L(r,e,t,n,o){n===void 0&&(n=0),o===void 0&&(o=!1);var i=e.schedule(function(){t(),o?r.add(this.schedule(null,n)):this.unsubscribe()},n);if(r.add(i),!o)return i}function et(r,e){return e===void 0&&(e=0),S(function(t,n){t.subscribe(y(n,function(o){return L(n,r,function(){return n.next(o)},e)},function(){return L(n,r,function(){return n.complete()},e)},function(o){return L(n,r,function(){return n.error(o)},e)}))})}function tt(r,e){return e===void 0&&(e=0),S(function(t,n){n.add(r.schedule(function(){return t.subscribe(n)},e))})}function yr(r,e){return T(r).pipe(tt(e),et(e))}function gr(r,e){return T(r).pipe(tt(e),et(e))}function Sr(r,e){return new w(function(t){var n=0;return e.schedule(function(){n===r.length?t.complete():(t.next(r[n++]),t.closed||this.schedule())})})}function wr(r,e){return new w(function(t){var n;return L(t,e,function(){n=r[Je](),L(t,e,function(){var o,i,s;try{o=n.next(),i=o.value,s=o.done}catch(a){t.error(a);return}s?t.complete():t.next(i)},0,!0)}),function(){return x(n?.return)&&n.return()}})}function rt(r,e){if(!r)throw new Error("Iterable cannot be null");return new w(function(t){L(t,e,function(){var n=r[Symbol.asyncIterator]();L(t,e,function(){n.next().then(function(o){o.done?t.complete():t.next(o.value)})},0,!0)})})}function Tr(r,e){return rt(Ze(r),e)}function $r(r,e){if(r!=null){if(He(r))return yr(r,e);if(ze(r))return Sr(r,e);if(Ye(r))return gr(r,e);if(Ke(r))return rt(r,e);if(Xe(r))return wr(r,e);if(Qe(r))return Tr(r,e)}throw qe(r)}function z(r,e){return e?$r(r,e):T(r)}function Ce(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];var t=K(r);return z(r,t)}var Mr=me(function(r){return function(){r(this),this.name="EmptyError",this.message="no elements in sequence"}});function ne(r,e){var t=typeof e=="object";return new Promise(function(n,o){var i=new G({next:function(s){n(s),i.unsubscribe()},error:o,complete:function(){t?n(e.defaultValue):o(new Mr)}});r.subscribe(i)})}function Cr(r){return r instanceof Date&&!isNaN(r)}function m(r,e){return S(function(t,n){var o=0;t.subscribe(y(n,function(i){n.next(r.call(e,i,o++))}))})}var Bn=Array.isArray;function Vn(r,e){return Bn(e)?r.apply(void 0,D([],P(e))):r(e)}function _r(r){return m(function(e){return Vn(r,e)})}var Un=Array.isArray,Wn=Object.getPrototypeOf,Nn=Object.prototype,Gn=Object.keys;function Er(r){if(r.length===1){var e=r[0];if(Un(e))return{args:e,keys:null};if(zn(e)){var t=Gn(e);return{args:t.map(function(n){return e[n]}),keys:t}}}return{args:r,keys:null}}function zn(r){return r&&typeof r=="object"&&Wn(r)===Nn}function Ir(r,e){return r.reduce(function(t,n,o){return t[n]=e[o],t},{})}function de(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];var t=K(r),n=Ge(r),o=Er(r),i=o.args,s=o.keys;if(i.length===0)return z([],t);var a=new w(Yn(i,t,s?function(u){return Ir(s,u)}:A));return n?a.pipe(_r(n)):a}function Yn(r,e,t){return t===void 0&&(t=A),function(n){kr(e,function(){for(var o=r.length,i=new Array(o),s=o,a=o,u=function(p){kr(e,function(){var f=z(r[p],e),v=!1;f.subscribe(y(n,function(h){i[p]=h,v||(v=!0,a--),a||n.next(t(i.slice()))},function(){--s||n.complete()}))},n)},c=0;c<o;c++)u(c)},n)}}function kr(r,e,t){r?L(t,r,e):e()}function Or(r,e,t,n,o,i,s,a){var u=[],c=0,p=0,f=!1,v=function(){f&&!u.length&&!c&&e.complete()},h=function(d){return c<n?$(d):u.push(d)},$=function(d){i&&e.next(d),c++;var k=!1;T(t(d,p++)).subscribe(y(e,function(F){o?.(F),i?h(F):e.next(F)},function(){k=!0},void 0,function(){if(k)try{c--;for(var F=function(){var pe=u.shift();s?L(e,s,function(){return $(pe)}):$(pe)};u.length&&c<n;)F();v()}catch(pe){e.error(pe)}}))};return r.subscribe(y(e,h,function(){f=!0,v()})),function(){a?.()}}function q(r,e,t){return t===void 0&&(t=1/0),x(e)?q(function(n,o){return m(function(i,s){return e(n,i,o,s)})(T(r(n,o)))},t):(typeof e=="number"&&(t=e),S(function(n,o){return Or(n,o,r,t)}))}function nt(r){return r===void 0&&(r=1/0),q(A,r)}function Pr(){return nt(1)}function Dr(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];return Pr()(z(r,K(r)))}function Ar(r){return new w(function(e){T(r()).subscribe(e)})}var Hn={connector:function(){return new E},resetOnDisconnect:!0};function ot(r,e){e===void 0&&(e=Hn);var t=null,n=e.connector,o=e.resetOnDisconnect,i=o===void 0?!0:o,s=n(),a=new w(function(u){return s.subscribe(u)});return a.connect=function(){return(!t||t.closed)&&(t=Ar(function(){return r}).subscribe(s),i&&t.add(function(){return s=n()})),t},a}function R(r,e,t){r===void 0&&(r=0),t===void 0&&(t=br);var n=-1;return e!=null&&(Ne(e)?t=e:n=e),new w(function(o){var i=Cr(r)?+r-t.now():r;i<0&&(i=0);var s=0;return t.schedule(function(){o.closed||(o.next(s++),0<=n?this.schedule(void 0,n):o.complete())},i)})}function _e(r,e){return r===void 0&&(r=0),e===void 0&&(e=re),r<0&&(r=0),R(r,r,e)}function Rt(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];var t=K(r),n=vr(r,1/0),o=r;return o.length?o.length===1?T(o[0]):nt(n)(z(o,t)):We}var Kn=Array.isArray;function Lr(r){return r.length===1&&Kn(r[0])?r[0]:r}function C(r,e){return S(function(t,n){var o=0;t.subscribe(y(n,function(i){return r.call(e,i,o++)&&n.next(i)}))})}function Bt(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];return r=Lr(r),r.length===1?T(r[0]):new w(qn(r))}function qn(r){return function(e){for(var t=[],n=function(i){t.push(T(r[i]).subscribe(y(e,function(s){if(t){for(var a=0;a<t.length;a++)a!==i&&t[a].unsubscribe();t=null}e.next(s)})))},o=0;t&&!e.closed&&o<r.length;o++)n(o)}}function Fr(r,e,t,n,o){return function(i,s){var a=t,u=e,c=0;i.subscribe(y(s,function(p){var f=c++;u=a?r(u,p,f):(a=!0,p),n&&s.next(u)},o&&(function(){a&&s.next(u),s.complete()})))}}function Vt(r,e){return e===void 0&&(e=re),S(function(t,n){var o=null,i=null,s=null,a=function(){if(o){o.unsubscribe(),o=null;var c=i;i=null,n.next(c)}};function u(){var c=s+r,p=e.now();if(p<c){o=this.schedule(void 0,c-p),n.add(o);return}a()}t.subscribe(y(n,function(c){i=c,s=e.now(),o||(o=e.schedule(u,r),n.add(o))},function(){a(),n.complete()},void 0,function(){i=o=null}))})}function l(r){return r<=0?function(){return We}:S(function(e,t){var n=0;e.subscribe(y(t,function(o){++n<=r&&(t.next(o),r<=n&&t.complete())}))})}function jr(){return S(function(r,e){r.subscribe(y(e,N))})}function Rr(r){return m(function(){return r})}function Ut(r,e){return e?function(t){return Dr(e.pipe(l(1),jr()),t.pipe(Ut(r)))}:q(function(t,n){return T(r(t,n)).pipe(l(1),Rr(t))})}function Wt(r,e){e===void 0&&(e=re);var t=R(r,e);return Ut(function(){return t})}function Ee(r,e){return e===void 0&&(e=A),r=r??Jn,S(function(t,n){var o,i=!0;t.subscribe(y(n,function(s){var a=e(s);(i||!r(o,a))&&(i=!1,o=a,n.next(s))}))})}function Jn(r,e){return r===e}function Nt(r){r===void 0&&(r=1/0);var e;r&&typeof r=="object"?e=r:e={count:r};var t=e.count,n=t===void 0?1/0:t,o=e.delay,i=e.resetOnSuccess,s=i===void 0?!1:i;return n<=0?A:S(function(a,u){var c=0,p,f=function(){var v=!1;p=a.subscribe(y(u,function(h){s&&(c=0),u.next(h)},void 0,function(h){if(c++<n){var $=function(){p?(p.unsubscribe(),p=null,f()):v=!0};if(o!=null){var d=typeof o=="number"?R(o):T(o(h,c)),k=y(u,function(){k.unsubscribe(),$()},function(){u.complete()});d.subscribe(k)}else $()}else u.error(h)})),v&&(p.unsubscribe(),p=null,f())};f()})}function it(r,e){return S(Fr(r,e,arguments.length>=2,!0))}function Ie(r){r===void 0&&(r={});var e=r.connector,t=e===void 0?function(){return new E}:e,n=r.resetOnError,o=n===void 0?!0:n,i=r.resetOnComplete,s=i===void 0?!0:i,a=r.resetOnRefCountZero,u=a===void 0?!0:a;return function(c){var p,f,v,h=0,$=!1,d=!1,k=function(){f?.unsubscribe(),f=void 0},F=function(){k(),p=v=void 0,$=d=!1},pe=function(){var Te=p;F(),Te?.unsubscribe()};return S(function(Te,rr){h++,!d&&!$&&k();var De=v=v??t();rr.add(function(){h--,h===0&&!d&&!$&&(f=Gt(pe,u))}),De.subscribe(rr),!p&&h>0&&(p=new G({next:function(Ae){return De.next(Ae)},error:function(Ae){d=!0,k(),f=Gt(F,o,Ae),De.error(Ae)},complete:function(){$=!0,k(),f=Gt(F,s),De.complete()}}),T(Te).subscribe(p))})(c)}}function Gt(r,e){for(var t=[],n=2;n<arguments.length;n++)t[n-2]=arguments[n];if(e===!0){r();return}if(e!==!1){var o=new G({next:function(){o.unsubscribe(),r()}});return T(e.apply(void 0,D([],P(t)))).subscribe(o)}}function Y(r,e){return S(function(t,n){var o=null,i=0,s=!1,a=function(){return s&&!o&&n.complete()};t.subscribe(y(n,function(u){o?.unsubscribe();var c=0,p=i++;T(r(u,p)).subscribe(o=y(n,function(f){return n.next(e?e(u,f,p,c++):f)},function(){o=null,a()}))},function(){s=!0,a()}))})}function be(r){return S(function(e,t){T(r).subscribe(y(t,function(){return t.complete()},N)),!t.closed&&e.subscribe(t)})}function st(r,e,t){var n=x(r)||e||t?{next:r,error:e,complete:t}:r;return n?S(function(o,i){var s;(s=n.subscribe)===null||s===void 0||s.call(n);var a=!0;o.subscribe(y(i,function(u){var c;(c=n.next)===null||c===void 0||c.call(n,u),i.next(u)},function(){var u;a=!1,(u=n.complete)===null||u===void 0||u.call(n),i.complete()},function(u){var c;a=!1,(c=n.error)===null||c===void 0||c.call(n,u),i.error(u)},function(){var u,c;a&&((u=n.unsubscribe)===null||u===void 0||u.call(n)),(c=n.finalize)===null||c===void 0||c.call(n)}))}):A}function oe(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];var t=Ge(r);return S(function(n,o){for(var i=r.length,s=new Array(i),a=r.map(function(){return!1}),u=!1,c=function(f){T(r[f]).subscribe(y(o,function(v){s[f]=v,!u&&!a[f]&&(a[f]=!0,(u=a.every(A))&&(a=null))},N))},p=0;p<i;p++)c(p);n.subscribe(y(o,function(f){if(u){var v=D([f],P(s));o.next(t?t.apply(void 0,D([],P(v))):v)}}))})}function _(r,e,t){return r[e]??t}function O(...r){return r.join(".")}var b=r=>At(m(e=>r(e)),Ee(),C(e=>e!==void 0)),g=(r,e)=>b(t=>_(t,r,e)),Br=(r,e,t,n,o,i=1)=>{switch(o){case"master":{let s=O(t,n-1,r);return a=>_(a,s,e)}case"aux":case"fx":return s=>{let a=O(t,n-1,o,i-1,r);return _(s,a,e)}}},Vr=()=>r=>_(r,"m.mix"),Ur=()=>r=>_(r,"m.pan"),Wr=()=>r=>_(r,"m.dim"),zt=r=>e=>_(e,`m.delay${r}`,0)*1e3,at=(r,e,t,n)=>Br("pan",0,r,e,t,n),Nr=(r,e,t,n)=>Br("mute",0,r,e,t,n),Gr=(r,e)=>{let t=O(r,e-1,"solo");return n=>_(n,t)},zr=(r,e,t,n=1)=>{switch(t){case"master":{let o=O(r,e-1,"mix");return i=>_(i,o)}case"aux":case"fx":{let o=O(r,e-1,t,n-1,"value");return i=>_(i,o)}}},Yr=(r,e)=>{let t=O(r,e-1,"delay");return n=>_(n,t,0)*1e3},Hr=(r,e,t,n)=>{let o=O(r,e-1,t,n-1,"post");return i=>_(i,o,0)};var Kr=(r=1)=>{let e=O("f",r-1,"bpm");return t=>_(t,e)},qr=(r=1)=>{let e=O("f",r-1,"fxtype");return t=>_(t,e)},ut=(r,e)=>{let t=O(r,e-1,"stereoIndex");return n=>["i","l","p","a"].includes(r)?_(n,t,-1):-1},Yt=(r,e)=>{let t=O(e,r-1,"phantom");return n=>_(n,t)},Ht=(r,e)=>{let t=O(e,r-1,"gain");return n=>_(n,t)},Jr=(r,e)=>{let t=O("settings",r,...e!==void 0&&e>=0?[e]:[]);return n=>_(n,t)},ct=()=>r=>_(r,"var.currentLength",-1),Xr=()=>r=>_(r,"var.currentTrackPos",0),Kt=(r,e)=>Math.max(0,Math.floor(r*e)),Zr=(r,e)=>Math.max(0,Math.floor(e-Kt(r,e))),Qr=()=>r=>{let e=Xr()(r),t=ct()(r);return Kt(e,t)},en=()=>r=>{let e=Xr()(r),t=ct()(r);return Zr(e,t)},pt=()=>r=>_(r,"var.mtk.currentLength",-1),tn=()=>r=>_(r,"var.mtk.currentTrackPos",0),rn=()=>r=>{let e=tn()(r),t=pt()(r);return Kt(e,t)},nn=()=>r=>{let e=tn()(r),t=pt()(r);return Zr(e,t)};var qt=(s=>(s.Opening="OPENING",s.Open="OPEN",s.Close="CLOSE",s.Closing="CLOSING",s.Error="ERROR",s.Reconnecting="RECONNECTING",s))(qt||{}),on=(n=>(n[n.Stopped=0]="Stopped",n[n.Playing=2]="Playing",n[n.Paused=3]="Paused",n))(on||{}),sn=(n=>(n[n.Stopped=0]="Stopped",n[n.Paused=1]="Paused",n[n.Playing=2]="Playing",n))(sn||{}),an=(i=>(i[i.None=-1]="None",i[i.Reverb=0]="Reverb",i[i.Delay=1]="Delay",i[i.Chorus=2]="Chorus",i[i.Room=3]="Room",i))(an||{});function M(r,e,t){return Math.min(t,Math.max(e,r))}function ve(r){return Math.round((r+Number.EPSILON)*1e3)/1e3}function cn(r){return r.match(/^-?\d+$/)?parseInt(r,10):r.match(/^\d+\.\d+$/)?parseFloat(r):r}function wp(r){if(r<0)return"";let e=Math.floor(r),t=Math.floor(e/60),n=e%60;return`${t}:${n.toString().length===1?"0":""}${n}`}function ie(r,e){switch(e){case 1:return r-1;case 0:return r+1;default:return r}}function un(r){switch(r){case 1:return"L";case 2:return"R";default:return""}}function Tp(r){switch(r){case-1:return"None";case 2:return"Chorus";case 0:return"Reverb";case 1:return"Delay";case 3:return"Room"}}function mt(r,e){switch(r){case"i":return"CH "+e;case"a":return"AUX "+e;case"f":return"FX "+e;case"s":return"SUB "+e;case"v":return"VCA "+e;case"l":return"LINE IN "+un(e);case"p":return"PLAYER "+un(e);case"solovol":return"SOLO LEVEL";case"hpvol":return`HEADPHONE ${e} LEVEL`}}function Jt(r){return ne(Bt(r.state$.pipe(Vt(25)),R(250)))}var Xt=[[-1/0,0],[-100,.00126941502],[-99,.0014193058],[-98,.00158625841],[-97,.00177210569],[-96,.0019787848],[-95,.00220842659],[-94,.00246331096],[-93,.00274592638],[-92,.00305891037],[-91,.00340510905],[-90,.00378751755],[-89,.00420932472],[-88,.00467389822],[-87,.00518476963],[-86,.00574563444],[-85,.00636033714],[-84,.00703287125],[-83,.00776734948],[-82,.00856804848],[-81,.00943937898],[-80,.01038584113],[-79,.01141215861],[-78,.01252317429],[-77,.01372399926],[-76,.01501996815],[-75,.0164167881],[-74,.01792064309],[-73,.01953828335],[-72,.02127727866],[-71,.02314623445],[-70,.02515518665],[-69,.02731607854],[-68,.02964346856],[-67,.03215561062],[-66,.03487607837],[-65,.0378363952],[-64,.04108065367],[-63,.04467409104],[-62,.04872117192],[-61,.05341050774],[-60,.05882352591],[-59,.06435465068],[-58,.06995738298],[-57,.07563393563],[-56,.08138664067],[-55,.08721791208],[-54,.09313031286],[-53,.09912653267],[-52,.10520938411],[-51,.11138185114],[-50,.11764705926],[-49,.12400831282],[-48,.13046910241],[-47,.13703311235],[-46,.14370423928],[-45,.15048661083],[-44,.15738460608],[-43,.16440286487],[-42,.17154632322],[-41,.17882022634],[-40,.18623016588],[-39,.19378209766],[-38,.20148238726],[-37,.20933783613],[-36,.21735573001],[-35,.22554387664],[-34,.23391066305],[-33,.24246510724],[-32,.25121692196],[-31,.26017658552],[-30,.26935542002],[-29.9,.27028582105],[-29.8,.27121854806],[-29.7,.27215361455],[-29.6,.2730910331],[-29.5,.27403081628],[-29.4,.27497297851],[-29.3,.27591753239],[-29.2,.2768644914],[-29.1,.27781386906],[-29,.27876567934],[-28.9,.27971993526],[-28.8,.28067665175],[-28.7,.28163584229],[-28.6,.28259752039],[-28.5,.28356170142],[-28.4,.28452839889],[-28.3,.28549762792],[-28.2,.28646940272],[-28.1,.2874437375],[-28,.28842064831],[-27.9,.28940014914],[-27.8,.29038225533],[-27.7,.29136698227],[-27.6,.29235434486],[-27.5,.29334435938],[-27.4,.29433704074],[-27.3,.29533240478],[-27.2,.2963304678],[-27.1,.29733124515],[-27,.29833475361],[-26.9,.29934100923],[-26.8,.30035002832],[-26.7,.30136182765],[-26.6,.3023764235],[-26.5,.30339383334],[-26.4,.30441407394],[-26.3,.30543716229],[-26.2,.30646311585],[-26.1,.30749195209],[-26,.30852368847],[-25.9,.30955834268],[-25.8,.31059593312],[-25.7,.31163647724],[-25.6,.31267999392],[-25.5,.31372650107],[-25.4,.31477601733],[-25.3,.31582856132],[-25.2,.31688415236],[-25.1,.31794280931],[-25,.31900455104],[-24.9,.32006939733],[-24.8,.32113736775],[-24.7,.32220848184],[-24.6,.32328275964],[-24.5,.32436022116],[-24.4,.32544088666],[-24.3,.32652477687],[-24.2,.32761191227],[-24.1,.32870231359],[-24,.32979600201],[-23.9,.33089299873],[-23.8,.33199332491],[-23.7,.33309700247],[-23.6,.33420405304],[-23.5,.33531449875],[-23.4,.33642836171],[-23.3,.33754566452],[-23.2,.33866642928],[-23.1,.33979067928],[-23,.34091843711],[-22.9,.34204972652],[-22.8,.34318457078],[-22.7,.34432299319],[-22.6,.34546501818],[-22.5,.34661066951],[-22.4,.3477599714],[-22.3,.34891294874],[-22.2,.35006962623],[-22.1,.35123002878],[-22,.35239418154],[-21.9,.35356211034],[-21.8,.35473384033],[-21.7,.35590939806],[-21.6,.35708880937],[-21.5,.35827210057],[-21.4,.35945929866],[-21.3,.36065043067],[-21.2,.36184552335],[-21.1,.36304460443],[-21,.3642477016],[-20.9,.36545484257],[-20.8,.36666605598],[-20.7,.36788136989],[-20.6,.36910081329],[-20.5,.37032441515],[-20.4,.37155220495],[-20.3,.37278421177],[-20.2,.37402046612],[-20.1,.37526099756],[-20,.37650583661],[-19.9,.37775501423],[-19.8,.37900856114],[-19.7,.38026650855],[-19.6,.38152888836],[-19.5,.38279573224],[-19.4,.38406707242],[-19.3,.38534294115],[-19.2,.38662337163],[-19.1,.38790839631],[-19,.3891980492],[-18.9,.3904923636],[-18.8,.39179137361],[-18.7,.39309511357],[-18.6,.39440361829],[-18.5,.39571692259],[-18.4,.39703506161],[-18.3,.39835807122],[-18.2,.39968598739],[-18.1,.40101884631],[-18,.40235668444],[-17.9,.40369953902],[-17.8,.40504744719],[-17.7,.40640044678],[-17.6,.4077585754],[-17.5,.40912187181],[-17.4,.41049037443],[-17.3,.41186412238],[-17.2,.413243155],[-17.1,.41462751222],[-17,.41601723386],[-16.9,.41741236055],[-16.8,.41881293315],[-16.7,.42021899263],[-16.6,.42163058079],[-16.5,.42304773943],[-16.4,.4244705108],[-16.3,.42589893762],[-16.2,.42733306286],[-16.1,.42877293006],[-16,.43021858274],[-15.9,.43167006527],[-15.8,.433127422],[-15.7,.43459069787],[-15.6,.43605993828],[-15.5,.43753518863],[-15.4,.43901649513],[-15.3,.44050390413],[-15.2,.4419974623],[-15.1,.44349721679],[-15,.44500321534],[-14.9,.44651550555],[-14.8,.44803413586],[-14.7,.4495591548],[-14.6,.4510906114],[-14.5,.45262855513],[-14.4,.45417303545],[-14.3,.45572410279],[-14.2,.45728180732],[-14.1,.45884620002],[-14,.46041733201],[-13.9,.46199525474],[-13.8,.46358002012],[-13.7,.46517168032],[-13.6,.46677028784],[-13.5,.46837589552],[-13.4,.46998855658],[-13.3,.47160832456],[-13.2,.47323525313],[-13.1,.47486939642],[-13,.47651080892],[-12.9,.47815954522],[-12.8,.47981566039],[-12.7,.4814792095],[-12.6,.48315024807],[-12.5,.48482883186],[-12.4,.48651501676],[-12.3,.48820885899],[-12.2,.48991041491],[-12.1,.49161974108],[-12,.49333689432],[-11.9,.49506193132],[-11.8,.49679490936],[-11.7,.49853588548],[-11.6,.50028491695],[-11.5,.5020420613],[-11.4,.50380737579],[-11.3,.50558091793],[-11.2,.50736274524],[-11.1,.50915291533],[-11,.51095148548],[-10.9,.51275851321],[-10.8,.51457405591],[-10.7,.51639817073],[-10.6,.51823091484],[-10.5,.52007234516],[-10.4,.52192251827],[-10.3,.52378149075],[-10.2,.52564931882],[-10.1,.52752605826],[-10,.5294117647],[-9.9,.53130649327],[-9.8,.53321029863],[-9.7,.53512323508],[-9.6,.53704535618],[-9.5,.53897671518],[-9.4,.54091736441],[-9.3,.54286735586],[-9.2,.54482674052],[-9.1,.54679556866],[-9,.54877388978],[-8.9,.5507617523],[-8.8,.55275920394],[-8.7,.55476629105],[-8.6,.55678305926],[-8.5,.55880955269],[-8.4,.56084581441],[-8.3,.5628918861],[-8.2,.56494780804],[-8.1,.56701361912],[-8,.56908935658],[-7.9,.57117505604],[-7.8,.57327075163],[-7.7,.57537647523],[-7.6,.57749225723],[-7.5,.5796181258],[-7.4,.58175410703],[-7.3,.58390022506],[-7.2,.58605650149],[-7.1,.58822295559],[-7,.59039960429],[-6.9,.59258646169],[-6.8,.59478353942],[-6.7,.59699084621],[-6.6,.59920838778],[-6.5,.60143616702],[-6.4,.60367418348],[-6.3,.60592243349],[-6.2,.60818091012],[-6.1,.61044960283],[-6,.61272849748],[-5.9,.6150175762],[-5.8,.61731681728],[-5.7,.61962619505],[-5.6,.62194567965],[-5.5,.62427523721],[-5.4,.62661482923],[-5.3,.62896441302],[-5.2,.63132394117],[-5.1,.63369336171],[-5,.63607261766],[-4.9,.63846164738],[-4.8,.64086038404],[-4.7,.64326875575],[-4.6,.6456866854],[-4.5,.64811409055],[-4.4,.65055088326],[-4.3,.65299697022],[-4.2,.65545225237],[-4.1,.6579166252],[-4,.66038997821],[-3.9,.6628721953],[-3.8,.66536315437],[-3.7,.66786272742],[-3.6,.67037078051],[-3.5,.67288717377],[-3.4,.67541176116],[-3.3,.67794439074],[-3.2,.68048490444],[-3.1,.68303313828],[-3,.685588922],[-2.9,.68815207965],[-2.8,.69072242902],[-2.7,.69329978223],[-2.6,.69588394539],[-2.5,.69847471884],[-2.4,.70107189735],[-2.3,.70367526991],[-2.2,.70628462004],[-2.1,.7088997261],[-2,.7115203609],[-1.9,.71414629236],[-1.8,.71677728344],[-1.7,.71941309224],[-1.6,.72205347242],[-1.5,.72469817317],[-1.4,.7273469395],[-1.3,.72999951243],[-1.2,.73265562946],[-1.1,.7353150243],[-1,.73797742761],[-.9,.74064256705],[-.8,.74331016751],[-.7,.7459799514],[-.6,.74865163909],[-.5,.75132494903],[-.4,.75399959798],[-.3,.75667530153],[-.2,.75935177424],[-.1,.76202873001],[0,.76470588235],[.1,.7673829447],[.2,.77005963068],[.3,.77273565461],[.4,.77541073144],[.5,.77808457747],[.6,.78075691027],[.7,.78342744932],[.8,.78609591597],[.9,.788762034],[1,.79142552969],[1.1,.79408613226],[1.2,.79674357391],[1.3,.79939759037],[1.4,.80204792085],[1.5,.80469430843],[1.6,.80733650032],[1.7,.80997424785],[1.8,.81260730696],[1.9,.81523543815],[2,.81785840681],[2.1,.82047598323],[2.2,.82308794296],[2.3,.82569406676],[2.4,.82829414081],[2.5,.83088795675],[2.6,.8334753119],[2.7,.83605600931],[2.8,.83862985772],[2.9,.84119667177],[3,.84375627202],[3.1,.84630848491],[3.2,.84885314284],[3.3,.85139008425],[3.4,.85391915357],[3.5,.85644020114],[3.6,.85895308337],[3.7,.86145766254],[3.8,.86395380691],[3.9,.86644139059],[4,.86892029358],[4.1,.87139040159],[4.2,.87385160607],[4.3,.87630380417],[4.4,.87874689855],[4.5,.8811807974],[4.6,.8836054143],[4.7,.88602066817],[4.8,.88842648314],[4.9,.89082278844],[5,.89320951837],[5.1,.89558661211],[5.2,.89795401365],[5.3,.90031167166],[5.4,.90265953944],[5.5,.9049975747],[5.6,.90732573954],[5.7,.90964400026],[5.8,.91195232733],[5.9,.91425069513],[6,.91653908203],[6.1,.91881747005],[6.2,.92108584497],[6.3,.92334419597],[6.4,.92559251573],[6.5,.92783080021],[6.6,.93005904852],[6.7,.93227726285],[6.8,.93448544835],[6.9,.93668361302],[7,.93887176758],[7.1,.94104992537],[7.2,.9432181023],[7.3,.94537631667],[7.4,.94752458909],[7.5,.94966294241],[7.6,.9517914016],[7.7,.95390999367],[7.8,.95601874754],[7.9,.95811769404],[8,.96020686568],[8.1,.96228629674],[8.2,.96435602299],[8.3,.96641608179],[8.4,.96846651193],[8.5,.97050735351],[8.6,.97253864795],[8.7,.9745604379],[8.8,.9765727671],[8.9,.97857568043],[9,.98056922374],[9.1,.98255344384],[9.2,.98452838843],[9.3,.98649410604],[9.4,.98845064599],[9.5,.99039805829],[9.6,.99233639364],[9.7,.99426570335],[9.8,.9961860393],[9.9,.99809745389],[10,1],[1/0,1]];function ft(r,e){return M(r,0,e)/1e3}function pn(r,e,t,n){for(let o=0;o<r.length;o++)if(!(r[o][t]<e))return o===0||o===1||e===r[o][t]?r[o][n]:r[o-1][n]+(r[o][n]-r[o-1][n])*(e-r[o-1][t])/(r[o][t]-r[o-1][t]);return r[0][n]}function U(r){return pn(Xt,r,0,1)}function se(r){let e=pn(Xt,r,1,0);return Math.round(e*10)/10}var ke=20,Zt=4e3;function mn(r){return Math.round((Zt-ke)*Math.pow(r,3.0517)+ke)}function fn(r){let e=M(r,ke,Zt),t=Math.pow((e-ke)/(Zt-ke),.32768620768751844);return Math.floor(t*1e7)/1e7}function Oe(r,e,t){let n=(r-e)/(t-e);return M(n,0,1)}function ae(r,e,t){let n=Math.round((r*(t-e)+e)*10)/10;return M(n,e,t)}var lt=class{constructor(e,t,n){this.conn=e;this.store=t;this.group=n;this.state$=this.store.state$.pipe(g(`automix.${this.group}.on`))}setState(e){this.conn.sendMessage(`SETD^automix.${this.group}.on^${e}`)}enable(){this.setState(1)}disable(){this.setState(0)}toggle(){this.state$.pipe(l(1)).subscribe(e=>this.setState(e^1))}},ht=class{constructor(e,t){this.conn=e;this.store=t;this.responseTime$=this.store.state$.pipe(g("automix.time"));this.responseTimeMs$=this.responseTime$.pipe(m(e=>mn(e)));this.groups={a:new lt(this.conn,this.store,"a"),b:new lt(this.conn,this.store,"b")}}setResponseTime(e){this.conn.sendMessage(`SETD^automix.time^${e}`)}setResponseTimeMs(e){this.setResponseTime(fn(e))}};var xe=(o=>(o[o.Linear=0]="Linear",o[o.EaseIn=1]="EaseIn",o[o.EaseOut=2]="EaseOut",o[o.EaseInOut=3]="EaseInOut",o))(xe||{}),Qt={0:r=>r,1:r=>r*r,2:r=>r*(2-r),3:r=>r*(2-r)};function ye(r,e,t){return r.pipe(oe(e),Y(([{targetValue:n,fadeTime:o,easing:i,fps:s},a])=>Xn(a,n,o,i,s).pipe(be(t.status$.pipe(C(u=>u.type==="CLOSE"))))))}function Xn(r,e,t,n,o){t=Math.max(t,o);let i=Math.round(1e3/o),s=Math.round(t/i);n=n||0;let a=Qt[n]||Qt[0];return _e(i).pipe(l(s),m(u=>a((u+1)/s)*(e-r)+r),Ee())}function ge(r){return new Promise(e=>setTimeout(()=>e(),r))}var J=class{constructor(e,t,n,o,i="master",s=0){this.conn=e;this.store=t;this.channelType=n;this.channel=o;this.busType=i;this.bus=s;this.fullChannelId=`${this.channelType}.${this.channel-1}`;this.faderLevelCommand="mix";this.linkedChannelIds=[];this.transitionSources$=new E;this.stereoIndex$=this.store.state$.pipe(b(ut(this.channelType,this.channel)));this.faderLevel$=this.store.state$.pipe(b(zr(this.channelType,this.channel,this.busType,this.bus)));this.faderLevelDB$=this.faderLevel$.pipe(m(e=>se(e)));this.mute$=this.store.state$.pipe(b(Nr(this.channelType,this.channel,this.busType,this.bus)));this.name$=this.store.state$.pipe(g(O(this.channelType,this.channel-1,"name")),m(e=>e||mt(this.channelType,this.channel)));let a=i+s+n+o,u=this.store.objectStore.get(a);if(u)return u;this.store.objectStore.set(a,this),ye(this.transitionSources$,this.faderLevel$,e).subscribe(c=>this.setFaderLevelRaw(c))}fadeTo(e,t,n=0,o=25){return e=M(e,0,1),this.transitionSources$.next({targetValue:e,fadeTime:t,easing:n,fps:o}),ge(t)}fadeToDB(e,t,n=0,o=25){let i=U(e);return this.fadeTo(i,t,n,o)}setFaderLevel(e){e=M(e,0,1),this.setFaderLevelRaw(e)}setFaderLevelRaw(e){[...this.linkedChannelIds,this.fullChannelId].forEach(t=>{let n=`SETD^${t}.${this.faderLevelCommand}^${e}`;this.conn.sendMessage(n)})}setFaderLevelDB(e){this.setFaderLevel(U(e))}changeFaderLevelDB(e){this.faderLevelDB$.pipe(l(1)).subscribe(t=>this.setFaderLevelDB(Math.max(t,-100)+e))}setMute(e){[...this.linkedChannelIds,this.fullChannelId].forEach(t=>{let n=`SETD^${t}.mute^${e}`;this.conn.sendMessage(n)})}mute(){this.setMute(1)}unmute(){this.setMute(0)}toggleMute(){this.mute$.pipe(l(1)).subscribe(e=>this.setMute(e^1))}setName(e){e=e.replace(/[\^]/gi,"").substring(0,20).toUpperCase();let t=O(this.channelType,this.channel-1,"name");this.conn.sendMessage(`SETS^${t}^${e}`)}};var Se=class extends J{constructor(t,n,o,i,s,a){super(t,n,o,i,s,a);this.fullChannelId=this.constructChannelId(this.channelType,this.channel,this.busType,this.bus);this.faderLevelCommand="value";this.post$=this.store.state$.pipe(b(Hr(this.channelType,this.channel,this.busType,this.bus)))}constructChannelId(t,n,o,i){return`${t}.${n-1}.${o}.${i-1}`}setPost(t){[...this.linkedChannelIds,this.fullChannelId].forEach(n=>{let o=`SETD^${n}.post^${t}`;this.conn.sendMessage(o)})}post(){this.setPost(1)}pre(){this.setPost(0)}togglePost(){this.post$.pipe(l(1)).subscribe(t=>this.setPost(t^1))}};var ue=class extends Se{constructor(t,n,o,i,s){super(t,n,o,i,"aux",s);this.auxLinkChannelIds=[];this.pan$=this.store.state$.pipe(b(at(this.channelType,this.channel,this.busType,this.bus)));de([this.store.state$.pipe(b(ut("a",s))),this.stereoIndex$]).pipe(m(([a,u])=>{let c=ie(s,a),p=ie(i,u),f=[],v=[];if(p!==void 0&&f.push(this.constructChannelId(o,p,this.busType,s)),c!==void 0){let h=this.constructChannelId(o,i,this.busType,c);f.push(h),v.push(h)}return c!==void 0&&p!==void 0&&f.push(this.constructChannelId(o,p,this.busType,c)),{allChannelIds:f,auxLinkChannelIds:v}})).subscribe(a=>{this.linkedChannelIds=a.allChannelIds,this.auxLinkChannelIds=a.auxLinkChannelIds})}setPan(t){t=M(t,0,1),t=ve(t),[...this.auxLinkChannelIds,this.fullChannelId].forEach(n=>{let o=`SETD^${n}.pan^${t}`;this.conn.sendMessage(o)})}changePan(t){this.pan$.pipe(l(1)).subscribe(n=>this.setPan(n+t))}setPostProc(t){[...this.linkedChannelIds,this.fullChannelId].forEach(n=>{let o=`SETD^${n}.postproc^${t}`;this.conn.sendMessage(o)})}postProc(){this.setPostProc(1)}preProc(){this.setPostProc(0)}};var dt=class{constructor(e,t,n){this.conn=e;this.store=t;this.bus=n}input(e){return new ue(this.conn,this.store,"i",e,this.bus)}line(e){return new ue(this.conn,this.store,"l",e,this.bus)}player(e){return new ue(this.conn,this.store,"p",e,this.bus)}fx(e){return new ue(this.conn,this.store,"f",e,this.bus)}};var bt=class{constructor(e){this.store=e;this.model$=this.store.state$.pipe(g("model"));this.firmware$=this.store.state$.pipe(g("firmware"));this.model$.subscribe(t=>this.model=t)}};var vt=class{constructor(e,t){this.conn=e;this.store=t;this.recording$=this.store.state$.pipe(g("var.isRecording",0));this.busy$=this.store.state$.pipe(g("var.recBusy",0))}recordToggle(){this.conn.sendMessage("RECTOGGLE")}recordStart(){this.recording$.pipe(l(1)).subscribe(e=>{e||this.recordToggle()})}recordStop(){this.recording$.pipe(l(1)).subscribe(e=>{e&&this.recordToggle()})}};var ce=class extends Se{constructor(e,t,n,o,i){super(e,t,n,o,"fx",i),this.stereoIndex$.pipe(m(s=>{let a=ie(o,s);return a!==void 0?[this.constructChannelId(this.channelType,a,this.busType,this.bus)]:[]})).subscribe(s=>this.linkedChannelIds=s)}};var xt=class{constructor(e,t,n){this.conn=e;this.store=t;this.bus=n;this.fxType$=this.store.state$.pipe(b(qr(this.bus)));this.bpm$=this.store.state$.pipe(b(Kr(this.bus)));let o="fxbus"+n,i=this.store.objectStore.get(o);if(i)return i;this.store.objectStore.set(o,this)}input(e){return new ce(this.conn,this.store,"i",e,this.bus)}line(e){return new ce(this.conn,this.store,"l",e,this.bus)}player(e){return new ce(this.conn,this.store,"p",e,this.bus)}sub(e){return new ce(this.conn,this.store,"s",e,this.bus)}setBpm(e){e=M(e,20,400),e=Math.round(e),this.conn.sendMessage(`SETD^f.${this.bus-1}.bpm^${e}`)}assertFxParamInRange(e){if(e<1||e>6)throw new Error("FX Parameter must be between 1 and 6.")}makeFxParamPath(e){return`f.${this.bus-1}.par${e}`}getParam(e){return this.assertFxParamInRange(e),this.store.state$.pipe(g(this.makeFxParamPath(e)))}setParam(e,t){this.assertFxParamInRange(e),t=M(t,0,1),this.conn.sendMessage(`SETD^${this.makeFxParamPath(e)}^${t}`)}};var yt=class{constructor(e,t,n,o){this.conn=e;this.store=t;this.deviceInfo=n;this.channel=o;this.fullChannelId=`hw.${this.channel-1}`;this.phantom$=this.deviceInfo.model$.pipe(Y(e=>{switch(e){case"ui24":return this.store.state$.pipe(b(Yt(this.channel,"hw")));case"ui16":case"ui12":return this.store.state$.pipe(b(Yt(this.channel,"i")))}}));this.gain$=this.deviceInfo.model$.pipe(Y(e=>{switch(e){case"ui24":return this.store.state$.pipe(b(Ht(this.channel,"hw")));case"ui16":case"ui12":return this.store.state$.pipe(b(Ht(this.channel,"i")))}}));this.gainDB$=this.deviceInfo.model$.pipe(Y(e=>{switch(e){case"ui24":return this.gain$.pipe(m(t=>ae(t,-6,57)));case"ui16":case"ui12":return this.gain$.pipe(m(t=>ae(t,-40,50)))}}));let i="hw"+o,s=this.store.objectStore.get(i);if(s)return s;this.store.objectStore.set(i,this),this.deviceInfo.model$.subscribe(a=>{switch(a){case"ui24":this.fullChannelId=`hw.${this.channel-1}`;return;case"ui16":case"ui12":this.fullChannelId=`i.${this.channel-1}`;return}})}setPhantom(e){let t=`SETD^${this.fullChannelId}.phantom^${e}`;this.conn.sendMessage(t)}phantomOn(){this.setPhantom(1)}phantomOff(){this.setPhantom(0)}togglePhantom(){this.phantom$.pipe(l(1)).subscribe(e=>this.setPhantom(e^1))}setGain(e){e=M(e,0,1);let t=`SETD^${this.fullChannelId}.gain^${e}`;this.conn.sendMessage(t)}setGainDB(e){switch(this.deviceInfo.model){case"ui24":this.setGain(Oe(e,-6,57));return;case"ui16":case"ui12":this.setGain(Oe(e,-40,50));return}}changeGainDB(e){this.gainDB$.pipe(l(1)).subscribe(t=>this.setGainDB(t+e))}};var B=class extends J{constructor(t,n,o,i){super(t,n,o,i);this.fullChannelId=this.constructChannelId(this.channelType,this.channel);this.faderLevelCommand="mix";this.solo$=this.store.state$.pipe(b(Gr(this.channelType,this.channel)));this.pan$=this.store.state$.pipe(b(at(this.channelType,this.channel,this.busType,this.bus)));this.automixGroup$=this.store.state$.pipe(g(`${this.fullChannelId}.amixgroup`),m(t=>{switch(t){case 0:return"a";case 1:return"b";default:return"none"}}));this.automixWeight$=this.store.state$.pipe(g(`${this.fullChannelId}.amix`));this.automixWeightDB$=this.automixWeight$.pipe(m(t=>ae(t,-12,12)));this.multiTrackSelected$=this.store.state$.pipe(g(`${this.fullChannelId}.mtkrec`));this.stereoIndex$.pipe(m(s=>{let a=ie(i,s);return a!==void 0?[this.constructChannelId(this.channelType,a)]:[]})).subscribe(s=>this.linkedChannelIds=s)}constructChannelId(t,n){return`${t}.${n-1}`}setPan(t){t=M(t,0,1),t=ve(t);let n=`SETD^${this.fullChannelId}.pan^${t}`;this.conn.sendMessage(n)}changePan(t){this.pan$.pipe(l(1)).subscribe(n=>this.setPan(n+t))}setSolo(t){[...this.linkedChannelIds,this.fullChannelId].forEach(n=>{let o=`SETD^${n}.solo^${t}`;this.conn.sendMessage(o)})}solo(){this.setSolo(1)}unsolo(){this.setSolo(0)}toggleSolo(){this.solo$.pipe(l(1)).subscribe(t=>this.setSolo(t^1))}multiTrackAssertChannelType(){if(this.channelType!=="i"&&this.channelType!=="l")throw new Error("Multitrack recording can only be used with input and line channels")}multiTrackSetSelection(t){this.multiTrackAssertChannelType();let n=`SETD^${this.fullChannelId}.mtkrec^${t}`;this.conn.sendMessage(n)}multiTrackSelect(){this.multiTrackSetSelection(1)}multiTrackUnselect(){this.multiTrackSetSelection(0)}multiTrackToggle(){this.multiTrackAssertChannelType(),this.multiTrackSelected$.pipe(l(1)).subscribe(t=>this.multiTrackSetSelection(t^1))}automixAssignGroup(t){if(this.channelType!=="i")throw new Error("Automix can only be used with input channels");let n=-1;switch(t){case"a":n=0;break;case"b":n=1;break;case"none":n=-1;break}[...this.linkedChannelIds,this.fullChannelId].forEach(o=>{let i=`SETD^${o}.amixgroup^${n}`;this.conn.sendMessage(i)})}automixRemove(){this.automixAssignGroup("none")}automixSetWeight(t){t=M(t,0,1),[...this.linkedChannelIds,this.fullChannelId].forEach(n=>{let o=`SETD^${n}.amix^${t}`;this.conn.sendMessage(o)})}automixSetWeightDB(t){this.automixSetWeight(Oe(t,-12,12))}automixChangeWeightDB(t){this.automixWeightDB$.pipe(l(1)).subscribe(n=>this.automixSetWeightDB(n+t))}};var X=class extends B{constructor(t,n,o,i){super(t,n,o,i);this.delay$=this.store.state$.pipe(b(Yr(this.channelType,this.channel)));this.delayMaxValueMs=250;o==="a"&&(this.delayMaxValueMs=500)}setDelay(t){let n=ft(t,this.delayMaxValueMs),o=`SETD^${this.fullChannelId}.delay^${n}`;this.conn.sendMessage(o)}changeDelay(t){this.delay$.pipe(l(1)).subscribe(n=>this.setDelay(n+t))}};var we=class{constructor(e,t){this.conn=e;this.store=t;this.name$=Ce("MASTER");this.faderLevel$=this.store.state$.pipe(b(Vr()));this.faderLevelDB$=this.faderLevel$.pipe(m(e=>se(e)));this.pan$=this.store.state$.pipe(b(Ur()));this.dim$=this.store.state$.pipe(b(Wr()));this.delayL$=this.store.state$.pipe(b(zt("L")));this.delayR$=this.store.state$.pipe(b(zt("R")));this.transitionSources$=new E;ye(this.transitionSources$,this.faderLevel$,e).subscribe(n=>this.setFaderLevelRaw(n))}input(e){return new X(this.conn,this.store,"i",e)}line(e){return new X(this.conn,this.store,"l",e)}player(e){return new B(this.conn,this.store,"p",e)}aux(e){return new X(this.conn,this.store,"a",e)}fx(e){return new B(this.conn,this.store,"f",e)}sub(e){return new B(this.conn,this.store,"s",e)}vca(e){return new B(this.conn,this.store,"v",e)}fadeTo(e,t,n=0,o=25){return e=M(e,0,1),this.transitionSources$.next({targetValue:e,fadeTime:t,easing:n,fps:o}),ge(t)}fadeToDB(e,t,n=0,o=25){let i=U(e);return this.fadeTo(i,t,n,o)}setFaderLevel(e){e=M(e,0,1),this.setFaderLevelRaw(e)}setFaderLevelRaw(e){let t=`SETD^m.mix^${e}`;this.conn.sendMessage(t)}setFaderLevelDB(e){this.setFaderLevel(U(e))}changeFaderLevelDB(e){this.faderLevelDB$.pipe(l(1)).subscribe(t=>this.setFaderLevelDB(Math.max(t,-100)+e))}setPan(e){e=M(e,0,1),e=ve(e);let t=`SETD^m.pan^${e}`;this.conn.sendMessage(t)}changePan(e){this.pan$.pipe(l(1)).subscribe(t=>this.setPan(t+e))}setDim(e){let t=`SETD^m.dim^${e}`;this.conn.sendMessage(t)}dim(){this.setDim(1)}undim(){this.setDim(0)}toggleDim(){this.dim$.pipe(l(1)).subscribe(e=>this.setDim(e^1))}setDelayL(e){this.setDelay(e,"L")}setDelayR(e){this.setDelay(e,"R")}changeDelayL(e){this.delayL$.pipe(l(1)).subscribe(t=>this.setDelayL(t+e))}changeDelayR(e){this.delayR$.pipe(l(1)).subscribe(t=>this.setDelayR(t+e))}setDelay(e,t){let n=ft(e,500);this.conn.sendMessage(`SETD^m.delay${t}^${n}`)}};var gt=class{constructor(e,t){this.conn=e;this.store=t;this.state$=this.store.state$.pipe(g("var.mtk.currentState",0));this.session$=this.store.state$.pipe(g("var.mtk.session"),m(e=>typeof e=="number"?e.toString().padStart(4,"0"):e));this.length$=this.store.state$.pipe(b(pt()));this.elapsedTime$=this.store.state$.pipe(b(rn()));this.remainingTime$=this.store.state$.pipe(b(nn()));this.recording$=this.store.state$.pipe(g("var.mtk.rec.currentState",0));this.busy$=this.store.state$.pipe(g("var.mtk.rec.busy",0));this.recordingTime$=this.store.state$.pipe(g("var.mtk.rec.time",0),oe(this.recording$),m(([e,t])=>t?e:0));this.soundcheck$=this.store.state$.pipe(g("var.mtk.soundcheck",0))}play(){this.conn.sendMessage("MTK_PLAY")}pause(){this.conn.sendMessage("MTK_PAUSE")}stop(){this.conn.sendMessage("MTK_STOP")}recordToggle(){this.conn.sendMessage("MTK_REC_TOGGLE")}recordStart(){this.recording$.pipe(l(1)).subscribe(e=>{e||this.recordToggle()})}recordStop(){this.recording$.pipe(l(1)).subscribe(e=>{e&&this.recordToggle()})}setSoundcheck(e){let t=`SETD^var.mtk.soundcheck^${e}`;this.conn.sendMessage(t)}activateSoundcheck(){this.setSoundcheck(1)}deactivateSoundcheck(){this.setSoundcheck(0)}toggleSoundcheck(){this.soundcheck$.pipe(l(1)).subscribe(e=>this.setSoundcheck(e^1))}};function ln(r,e){return e<0?r:r^1<<e}function hn(r,e){return e<0?r:r&~(1<<e)}function dn(r,e){return e<0?r:r|1<<e}function bn(r,e){return e<0?r:r&1<<e?1:0}function Zn(r){switch(r){case"all":return 23;case"fx":return 22;default:return r-1}}var St=class{constructor(e,t,n){this.conn=e;this.store=t;this.id=n;this.mgMask$=this.store.state$.pipe(g("mgmask"));this.state$=this.mgMask$.pipe(m(e=>bn(e,this.groupIndex)));this.groupIndex=Zn(n);let o="mutegroup"+n,i=this.store.objectStore.get(o);if(i)return i;this.store.objectStore.set(o,this)}mute(){this.mgMask$.pipe(l(1)).subscribe(e=>this.setMgMask(dn(e,this.groupIndex)))}unmute(){this.mgMask$.pipe(l(1)).subscribe(e=>this.setMgMask(hn(e,this.groupIndex)))}toggle(){this.mgMask$.pipe(l(1)).subscribe(e=>this.setMgMask(ln(e,this.groupIndex)))}setMgMask(e){let t=`SETD^mgmask^${e}`;this.conn.sendMessage(t)}};var wt=class{constructor(e,t){this.conn=e;this.store=t;this.state$=this.store.state$.pipe(g("var.currentState",0));this.playlist$=this.store.state$.pipe(g("var.currentPlaylist"));this.track$=this.store.state$.pipe(g("var.currentTrack"));this.length$=this.store.state$.pipe(b(ct()));this.elapsedTime$=this.store.state$.pipe(b(Qr()));this.remainingTime$=this.store.state$.pipe(b(en()));this.shuffle$=this.store.state$.pipe(g("settings.shuffle",0))}play(){this.conn.sendMessage("MEDIA_PLAY")}pause(){this.conn.sendMessage("MEDIA_PAUSE")}stop(){this.conn.sendMessage("MEDIA_STOP")}next(){this.conn.sendMessage("MEDIA_NEXT")}prev(){this.conn.sendMessage("MEDIA_PREV")}loadPlaylist(e){this.conn.sendMessage(`MEDIA_SWITCH_PLIST^${e}`)}loadTrack(e,t){this.conn.sendMessage(`MEDIA_SWITCH_TRACK^${e}^${t}`)}setShuffle(e){this.conn.sendMessage(`SETD^settings.shuffle^${e}`)}toggleShuffle(){this.shuffle$.pipe(l(1)).subscribe(e=>this.setShuffle(e^1))}setPlayMode(e){this.conn.sendMessage(`SETD^settings.playMode^${e}`)}setManual(){this.setPlayMode(0)}setAuto(){this.setPlayMode(3)}};var Tt=class{constructor(e,t){this.conn=e;this.store=t;this.currentShow$=this.store.state$.pipe(g("var.currentShow"));this.currentSnapshot$=this.store.state$.pipe(g("var.currentSnapshot"));this.currentCue$=this.store.state$.pipe(g("var.currentCue"))}loadShow(e){this.conn.sendMessage(`LOADSHOW^${e}`)}loadSnapshot(e,t){this.conn.sendMessage(`LOADSNAPSHOT^${e}^${t}`)}loadCue(e,t){this.conn.sendMessage(`LOADCUE^${e}^${t}`)}saveSnapshot(e,t){this.conn.sendMessage(`SAVESNAPSHOT^${e}^${t}`)}saveCue(e,t){this.conn.sendMessage(`SAVECUE^${e}^${t}`)}updateCurrentSnapshot(){de([this.currentShow$,this.currentSnapshot$]).pipe(l(1),C(([e,t])=>!!e&&!!t)).subscribe(([e,t])=>this.saveSnapshot(e,t))}updateCurrentCue(){de([this.currentShow$,this.currentCue$]).pipe(l(1),C(([e,t])=>!!e&&!!t)).subscribe(([e,t])=>this.saveCue(e,t))}};var Pe=class{constructor(e,t,n,o){this.conn=e;this.store=t;this.busName=n;this.busId=o;this.transitionSources$=new E;this.faderLevel$=this.store.state$.pipe(b(Jr(this.busName,this.busId?this.busId-1:void 0)));this.faderLevelDB$=this.faderLevel$.pipe(m(e=>se(e)));this.name$=Ce(mt(this.busName,this.busId||-1));let i="volume-"+this.busName+this.busId,s=this.store.objectStore.get(i);if(s)return s;this.store.objectStore.set(i,this),ye(this.transitionSources$,this.faderLevel$,e).subscribe(a=>this.setFaderLevelRaw(a))}fadeTo(e,t,n=0,o=25){return e=M(e,0,1),this.transitionSources$.next({targetValue:e,fadeTime:t,easing:n,fps:o}),ge(t)}fadeToDB(e,t,n=0,o=25){let i=U(e);return this.fadeTo(i,t,n,o)}setFaderLevel(e){e=M(e,0,1),this.setFaderLevelRaw(e)}setFaderLevelRaw(e){let n=`SETD^settings.${`${this.busName}${this.busId?"."+(this.busId-1):""}`}^${e}`;this.conn.sendMessage(n)}setFaderLevelDB(e){this.setFaderLevel(U(e))}changeFaderLevelDB(e){this.faderLevelDB$.pipe(l(1)).subscribe(t=>this.setFaderLevelDB(Math.max(t,-100)+e))}};var Qn={url:"",deserializer:function(r){return JSON.parse(r.data)},serializer:function(r){return JSON.stringify(r)}},eo="WebSocketSubject.error must be called with an object with an error code, and an optional reason: { code: number, reason: string }",vn=(function(r){I(e,r);function e(t,n){var o=r.call(this)||this;if(o._socket=null,t instanceof w)o.destination=n,o.source=t;else{var i=o._config=Le({},Qn);if(o._output=new E,typeof t=="string")i.url=t;else for(var s in t)t.hasOwnProperty(s)&&(i[s]=t[s]);if(!i.WebSocketCtor&&WebSocket)i.WebSocketCtor=WebSocket;else if(!i.WebSocketCtor)throw new Error("no WebSocket constructor can be found");o.destination=new H}return o}return e.prototype.lift=function(t){var n=new e(this._config,this.destination);return n.operator=t,n.source=this,n},e.prototype._resetState=function(){this._socket=null,this.source||(this.destination=new H),this._output=new E},e.prototype.multiplex=function(t,n,o){var i=this;return new w(function(s){try{i.next(t())}catch(u){s.error(u)}var a=i.subscribe({next:function(u){try{o(u)&&s.next(u)}catch(c){s.error(c)}},error:function(u){return s.error(u)},complete:function(){return s.complete()}});return function(){try{i.next(n())}catch(u){s.error(u)}a.unsubscribe()}})},e.prototype._connectSocket=function(){var t=this,n=this._config,o=n.WebSocketCtor,i=n.protocol,s=n.url,a=n.binaryType,u=this._output,c=null;try{c=i?new o(s,i):new o(s),this._socket=c,a&&(this._socket.binaryType=a)}catch(f){u.error(f);return}var p=new V(function(){t._socket=null,c&&c.readyState===1&&c.close()});c.onopen=function(f){var v=t._socket;if(!v){c.close(),t._resetState();return}var h=t._config.openObserver;h&&h.next(f);var $=t.destination;t.destination=te.create(function(d){if(c.readyState===1)try{var k=t._config.serializer;c.send(k(d))}catch(F){t.destination.error(F)}},function(d){var k=t._config.closingObserver;k&&k.next(void 0),d&&d.code?c.close(d.code,d.reason):u.error(new TypeError(eo)),t._resetState()},function(){var d=t._config.closingObserver;d&&d.next(void 0),c.close(),t._resetState()}),$&&$ instanceof H&&p.add($.subscribe(t.destination))},c.onerror=function(f){t._resetState(),u.error(f)},c.onclose=function(f){c===t._socket&&t._resetState();var v=t._config.closeObserver;v&&v.next(f),f.wasClean?u.complete():u.error(f)},c.onmessage=function(f){try{var v=t._config.deserializer;u.next(v(f))}catch(h){u.error(h)}}},e.prototype._subscribe=function(t){var n=this,o=this.source;return o?o.subscribe(t):(this._socket||this._connectSocket(),this._output.subscribe(t),t.add(function(){var i=n._socket;n._output.observers.length===0&&(i&&(i.readyState===1||i.readyState===0)&&i.close(),n._resetState())}),t)},e.prototype.unsubscribe=function(){var t=this._socket;t&&(t.readyState===1||t.readyState===0)&&t.close(),this._resetState(),r.prototype.unsubscribe.call(this)},e})(Ue);function er(r){return new vn(r)}var xn=WebSocket;var $t=class{constructor(e){this.reconnectTime=2e3;this.keepaliveTime=1e3;this.forceClose$=new E;this.statusSubject$=new E;this.outboundSubject$=new E;this.inboundSubject$=new E;this._status="CLOSE";this.status$=this.statusSubject$.asObservable();this.outbound$=this.outboundSubject$.asObservable();this.inbound$=this.inboundSubject$.asObservable();this.allMessages$=Rt(this.outbound$,this.inbound$);this.statusSubject$.subscribe(o=>{this._status=o.type}),this.socket$=er({url:`ws://${e.targetIP}`,WebSocketCtor:e.webSocketCtor||xn,serializer:o=>`3:::${o}`,deserializer:({data:o})=>o,openObserver:{next:()=>this.statusSubject$.next({type:"OPEN"})},closingObserver:{next:()=>this.statusSubject$.next({type:"CLOSING"})},closeObserver:{next:()=>this.statusSubject$.next({type:"CLOSE"})}});let t=this.status$.pipe(C(o=>o.type==="OPEN")),n=this.status$.pipe(C(o=>o.type==="CLOSE"));t.pipe(Y(()=>_e(this.keepaliveTime).pipe(be(n))),m(()=>"ALIVE")).subscribe(o=>this.outboundSubject$.next(o)),this.outbound$.subscribe(this.socket$)}get status(){return this._status}connect(){return this.statusSubject$.next({type:"OPENING"}),this.socket$.pipe(st({error:t=>this.statusSubject$.next({type:"ERROR",payload:t})}),Nt({delay:()=>R(this.reconnectTime).pipe(be(this.forceClose$),st(()=>this.statusSubject$.next({type:"RECONNECTING"})))}),m(t=>{let n=t.match(/^(3:::)([\s\S]*)/);return n&&n[2]}),C(t=>t!==null),q(t=>t.split(`
`))).subscribe(t=>this.inboundSubject$.next(t)),ne(this.status$.pipe(C(t=>t.type==="OPEN"),m(()=>{})))}disconnect(){return this.socket$.complete(),this.forceClose$.next(),ne(this.status$.pipe(C(e=>e.type==="CLOSE"),m(()=>{})))}reconnect(){return this.status$.pipe(C(e=>e.type==="CLOSE"),l(1),Wt(1e3)).subscribe(()=>this.connect()),this.disconnect(),ne(this.status$.pipe(C(e=>e.type==="OPEN"),m(()=>{})))}sendMessage(e){this.outboundSubject$.next(e)}};var Mt=class{constructor(){this.store=new Map}get(e){return this.store.get(e)}set(e,t){this.store.set(e,t)}};var Ct=class{constructor(e){this.conn=e;this.setdSetsMessageMatches$=this.conn.allMessages$.pipe(m(e=>e.match(/(SETD|SETS)\^([a-zA-Z0-9.]+)\^(.*)/)),C(e=>e!==null),Ie());this.messages$=this.setdSetsMessageMatches$.pipe(m(([e])=>e));this.state$=ot(this.setdSetsMessageMatches$.pipe(it((e,[,,t,n])=>(e[t]=cn(n),e),{})),{connector:()=>new H(1)});this.syncState$=ot(this.conn.allMessages$.pipe(C(e=>e.startsWith("BMSG^SYNC^")),m(e=>e.slice(10).split("^")),it((e,[t,n])=>({...e,[t]:parseInt(n,10)}),{})),{connector:()=>new H(1)});this.objectStore=new Mt;this.state$.connect(),this.syncState$.connect()}};function to(r){return ae(r,-80,0)}function yn(r){let e=atob(r),t=e.length,n=new Uint8Array(t);for(let o=0;o<t;o++)n[o]=e.charCodeAt(o);return n}function gn(r){let e=[{key:"input",amount:r[0],blockSize:6},{key:"player",amount:r[1],blockSize:6},{key:"sub",amount:r[2],blockSize:7},{key:"fx",amount:r[3],blockSize:7},{key:"aux",amount:r[4],blockSize:5},{key:"master",amount:r[5],blockSize:5},{key:"line",amount:r[6],blockSize:6}],t={input:[],player:[],sub:[],fx:[],aux:[],master:[],line:[]},n=.004167508166392142,o=8;return e.forEach(i=>{for(let s=0;s<(i.amount||0);s++){switch(i.key){case"input":case"player":case"line":{t[i.key].push({vuPre:r[o+0]*n,vuPost:r[o+1]*n,vuPostFader:r[o+2]*n});break}case"aux":{t[i.key].push({vuPost:r[o+0]*n,vuPostFader:r[o+1]*n});break}case"fx":case"sub":{t[i.key].push({vuPostL:r[o+0]*n,vuPostR:r[o+1]*n,vuPostFaderL:r[o+2]*n,vuPostFaderR:r[o+3]*n});break}case"master":{t[i.key].push({vuPost:r[o+0]*n,vuPostFader:r[o+1]*n});break}}o+=i.blockSize}}),t}var _t=class{constructor(e){this.conn=e;this.vuData$=this.conn.inbound$.pipe(C(e=>e.startsWith("VU2^")),m(e=>e.slice(4)),m(e=>gn(yn(e))),Ie())}input(e){return this.vuData$.pipe(m(t=>t.input[e-1]))}line(e){return this.vuData$.pipe(m(t=>t.line[e-1]))}player(e){return this.vuData$.pipe(m(t=>t.player[e-1]))}aux(e){return this.vuData$.pipe(m(t=>t.aux[e-1]))}fx(e){return this.vuData$.pipe(m(t=>t.fx[e-1]))}sub(e){return this.vuData$.pipe(m(t=>t.sub[e-1]))}master(){return this.vuData$.pipe(m(e=>{if(e.master.length<2)throw new Error("Master VU data has less than 2 channels.");return{vuPostL:e.master[0].vuPost,vuPostR:e.master[1].vuPost,vuPostFaderL:e.master[0].vuPostFader,vuPostFaderR:e.master[1].vuPostFader}}))}};var Sn={ui24:{0:["i",1],1:["i",2],2:["i",3],3:["i",4],4:["i",5],5:["i",6],6:["i",7],7:["i",8],8:["i",9],9:["i",10],10:["i",11],11:["i",12],12:["i",13],13:["i",14],14:["i",15],15:["i",16],16:["i",17],17:["i",18],18:["i",19],19:["i",20],20:["i",21],21:["i",22],22:["i",23],23:["i",24],24:["l",1],25:["l",2],26:["p",1],27:["p",2],28:["f",1],29:["f",2],30:["f",3],31:["f",4],32:["s",1],33:["s",2],34:["s",3],35:["s",4],36:["s",5],37:["s",6],38:["a",1],39:["a",2],40:["a",3],41:["a",4],42:["a",5],43:["a",6],44:["a",7],45:["a",8],46:["a",9],47:["a",10],48:["v",1],49:["v",2],50:["v",3],51:["v",4],52:["v",5],53:["v",6]},ui16:{0:["i",1],1:["i",2],2:["i",3],3:["i",4],4:["i",5],5:["i",6],6:["i",7],7:["i",8],8:["i",9],9:["i",10],10:["i",11],11:["i",12],12:["l",1],13:["l",2],14:["p",1],15:["p",2],16:["f",1],17:["f",2],18:["f",3],19:["f",4],20:["s",1],21:["s",2],22:["s",3],23:["s",4],24:["a",1],25:["a",2],26:["a",3],27:["a",4],28:["a",5],29:["a",6]},ui12:{0:["i",1],1:["i",2],2:["i",3],3:["i",4],4:["i",5],5:["i",6],6:["i",7],7:["i",8],8:["l",1],9:["l",2],10:["p",1],11:["p",2],12:["f",1],13:["f",2],14:["f",3],15:["f",4],16:["s",1],17:["s",2],18:["s",3],19:["s",4],20:["a",1],21:["a",2],22:["a",3],23:["a",4]}};function ro(r){return Sn[r]}function wn(r,e,t){let n=ro(e);if(t===-1)return r.master;if(n[t]!==void 0){let[o,i]=n[t];switch(o){case"i":return r.master.input(i);case"l":return r.master.line(i);case"p":return r.master.player(i);case"f":return r.master.fx(i);case"s":return r.master.sub(i);case"a":return r.master.aux(i);case"v":return r.master.vca(i)}}return null}function tr(r,e,t){if(e!=="master"&&t===void 0)throw new Error("Channel number is required");let n=Sn[r];if(e==="master")return-1;for(let[o,[i,s]]of Object.entries(n))if(i===e&&s===t)return+o;return null}var Et=class{constructor(e){this.sui=e;this.defaultSyncId="SYNC_ID"}getSelectedChannelIndex(e){let t=e||this.defaultSyncId;return this.sui.store.syncState$.pipe(m(n=>n[t]),C(n=>n!==void 0))}getSelectedChannel(e){return this.getSelectedChannelIndex(e).pipe(oe(this.sui.deviceInfo.model$),m(([t,n])=>wn(this.sui,n,t)))}selectChannelIndex(e,t){let n=`BMSG^SYNC^${t||this.defaultSyncId}^${e}`;this.sui.conn.sendMessage(n)}selectChannel(e,t,n){let o=this.sui.deviceInfo.model;if(o){if(e==="master"&&typeof t!="number"&&n===void 0){let i=tr(o,"master");if(i!==null){this.selectChannelIndex(i,t);return}}if(e!=="master"&&typeof t=="number"){let i=tr(o,e,t);if(i!==null){this.selectChannelIndex(i,n);return}}throw new Error("Invalid arguments or channel not found")}}};var Tn=class{get options(){return Object.freeze({...this._options})}constructor(e){typeof e=="string"?this._options={targetIP:e}:this._options=e,this.conn=new $t(this._options),this.store=new Ct(this.conn),this.deviceInfo=new bt(this.store),this.status$=this.conn.status$,this.vuProcessor=new _t(this.conn),this.master=new we(this.conn,this.store),this.player=new wt(this.conn,this.store),this.recorderDualTrack=new vt(this.conn,this.store),this.recorderMultiTrack=new gt(this.conn,this.store),this.volume={solo:new Pe(this.conn,this.store,"solovol"),headphone:t=>new Pe(this.conn,this.store,"hpvol",t)},this.shows=new Tt(this.conn,this.store),this.automix=new ht(this.conn,this.store),this.channelSync=new Et(this)}aux(e){return new dt(this.conn,this.store,e)}fx(e){return new xt(this.conn,this.store,e)}muteGroup(e){return new St(this.conn,this.store,e)}clearMuteGroups(){this.conn.sendMessage("SETD^mgmask^0")}hw(e){return new yt(this.conn,this.store,this.deviceInfo,e)}async connect(){await this.conn.connect(),await Jt(this.store)}disconnect(){return this.conn.disconnect()}async reconnect(){await this.conn.reconnect(),await Jt(this.store)}};function Yl(r){return r instanceof J}function Hl(r){return r instanceof B}function Kl(r){return r instanceof X}function ql(r){return r instanceof we}export{ht as AutomixController,lt as AutomixGroup,dt as AuxBus,ue as AuxChannel,J as Channel,Et as ChannelSync,qt as ConnectionStatus,U as DBToFaderValue,X as DelayableMasterChannel,bt as DeviceInfo,vt as DualTrackRecorder,xe as Easings,xt as FxBus,ce as FxChannel,an as FxType,yt as HwChannel,we as MasterBus,B as MasterChannel,sn as MtkState,gt as MultiTrackRecorder,St as MuteGroup,wt as Player,on as PlayerState,Se as SendChannel,Tt as ShowController,Tn as SoundcraftUI,Pe as VolumeBus,_t as VuProcessor,M as clamp,mt as constructReadableChannelName,se as faderValueToDB,Tp as fxTypeToString,ie as getLinkedChannelNumber,Yl as isChannel,Kl as isDelayableMasterChannel,ql as isMaster,Hl as isMasterChannel,wp as playerTimeToString,ve as roundToThreeDecimals,cn as transformStringValue,to as vuValueToDB,Jt as waitForInitParams};
